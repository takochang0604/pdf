<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF å£“ç¸®å·¥å…· â€” å®‰å…¨ã€å¿«é€Ÿã€å…ä¸Šå‚³</title>
  <meta name="description" content="åœ¨ç€è¦½å™¨ç«¯å®‰å…¨å£“ç¸® PDF æª”æ¡ˆï¼Œç„¡éœ€ä¸Šå‚³è‡³ä¼ºæœå™¨ï¼Œä¿éšœæ‚¨çš„éš±ç§å®‰å…¨ã€‚">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
    rel="stylesheet">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui', '-apple-system', 'sans-serif'],
          },
        },
      },
    }
  </script>

  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- ES Modules -->
  <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.292.0"
      }
    }
  </script>

  <style>
    /* === è‡ªå®šç¾©å‹•ç•« === */
    @keyframes gradientShift {

      0%,
      100% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0px) rotate(0deg);
        opacity: 0.6;
      }

      50% {
        transform: translateY(-20px) rotate(5deg);
        opacity: 1;
      }
    }

    @keyframes float-reverse {

      0%,
      100% {
        transform: translateY(0px) rotate(0deg);
        opacity: 0.5;
      }

      50% {
        transform: translateY(15px) rotate(-5deg);
        opacity: 0.9;
      }
    }

    @keyframes pulse-ring {
      0% {
        transform: scale(0.9);
        opacity: 0.7;
      }

      50% {
        transform: scale(1.1);
        opacity: 0.4;
      }

      100% {
        transform: scale(0.9);
        opacity: 0.7;
      }
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes shimmer {
      0% {
        background-position: -200% 0;
      }

      100% {
        background-position: 200% 0;
      }
    }

    @keyframes borderRotate {
      0% {
        --angle: 0deg;
      }

      100% {
        --angle: 360deg;
      }
    }

    @keyframes progressGlow {

      0%,
      100% {
        box-shadow: 0 0 5px rgba(99, 102, 241, 0.5);
      }

      50% {
        box-shadow: 0 0 20px rgba(99, 102, 241, 0.8);
      }
    }

    @keyframes celebrate {
      0% {
        transform: scale(0.8);
        opacity: 0;
      }

      50% {
        transform: scale(1.05);
      }

      100% {
        transform: scale(1);
        opacity: 1;
      }
    }

    @keyframes dash-move {
      0% {
        stroke-dashoffset: 0;
      }

      100% {
        stroke-dashoffset: -20;
      }
    }

    @keyframes spin-slow {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    .animate-gradient {
      animation: gradientShift 8s ease infinite;
      background-size: 200% 200%;
    }

    .animate-float {
      animation: float 6s ease-in-out infinite;
    }

    .animate-float-reverse {
      animation: float-reverse 7s ease-in-out infinite;
    }

    .animate-float-slow {
      animation: float 10s ease-in-out infinite;
    }

    .animate-pulse-ring {
      animation: pulse-ring 3s ease-in-out infinite;
    }

    .animate-slide-up {
      animation: slideUp 0.6s ease-out forwards;
    }

    .animate-fade-in {
      animation: fadeIn 0.5s ease-out forwards;
    }

    .animate-shimmer {
      animation: shimmer 2s linear infinite;
      background-size: 200% 100%;
    }

    .animate-celebrate {
      animation: celebrate 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    }

    .animate-spin-slow {
      animation: spin-slow 20s linear infinite;
    }

    /* ç»ç’ƒæ“¬æ…‹ */
    .glass {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .glass-card {
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.12);
    }

    .glass-light {
      background: rgba(255, 255, 255, 0.12);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }

    /* ä¸Šå‚³å€è™›ç·šå‹•ç•« */
    .upload-zone {
      position: relative;
      overflow: hidden;
    }

    .upload-zone::before {
      content: '';
      position: absolute;
      inset: 0;
      border: 2px dashed rgba(139, 92, 246, 0.4);
      border-radius: 1rem;
      pointer-events: none;
      transition: border-color 0.3s;
    }

    .upload-zone:hover::before {
      border-color: rgba(139, 92, 246, 0.8);
    }

    /* é¸ä¸­å¡ç‰‡çš„æ¼¸å±¤é‚Šæ¡† */
    .selected-card {
      position: relative;
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(168, 85, 247, 0.15));
      border: 1px solid rgba(139, 92, 246, 0.5);
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    /* é€²åº¦æ¢æ¼¸å±¤ */
    .progress-bar-gradient {
      background: linear-gradient(90deg, #6366f1, #a855f7, #ec4899, #a855f7, #6366f1);
      background-size: 200% 100%;
      animation: shimmer 1.5s linear infinite;
    }

    /* æŒ‰éˆ•æ¼¸å±¤ */
    .btn-primary {
      background: linear-gradient(135deg, #6366f1, #8b5cf6, #a855f7);
      transition: all 0.3s ease;
    }

    .btn-primary:hover:not(:disabled) {
      background: linear-gradient(135deg, #4f46e5, #7c3aed, #9333ea);
      box-shadow: 0 8px 30px rgba(99, 102, 241, 0.4);
      transform: translateY(-2px);
    }

    .btn-primary:active:not(:disabled) {
      transform: translateY(0);
    }

    .btn-success {
      background: linear-gradient(135deg, #10b981, #059669);
      transition: all 0.3s ease;
    }

    .btn-success:hover:not(:disabled) {
      background: linear-gradient(135deg, #059669, #047857);
      box-shadow: 0 8px 30px rgba(16, 185, 129, 0.4);
      transform: translateY(-2px);
    }

    /* æ»¾å‹•æ¢æ¨£å¼ */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.15);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.25);
    }

    /* å»¶é²å‹•ç•« */
    .delay-100 {
      animation-delay: 0.1s;
    }

    .delay-200 {
      animation-delay: 0.2s;
    }

    .delay-300 {
      animation-delay: 0.3s;
    }

    .delay-400 {
      animation-delay: 0.4s;
    }

    /* æ‹–æ›³æ™‚çš„æ•ˆæœ */
    .drag-active {
      background: rgba(139, 92, 246, 0.1) !important;
    }

    .drag-active::before {
      border-color: rgba(139, 92, 246, 1) !important;
    }
  </style>
</head>

<body class="min-h-screen font-sans text-white overflow-x-hidden"
  style="background: linear-gradient(135deg, #0f0b1e 0%, #1a1040 25%, #1e1145 50%, #15103a 75%, #0d0a1a 100%);">

  <!-- èƒŒæ™¯è£é£¾å…‰æšˆ -->
  <div class="fixed inset-0 pointer-events-none overflow-hidden" aria-hidden="true">
    <div class="absolute -top-40 -left-40 w-[500px] h-[500px] rounded-full bg-purple-600/10 blur-[120px] animate-float">
    </div>
    <div
      class="absolute top-1/3 -right-32 w-[400px] h-[400px] rounded-full bg-indigo-600/10 blur-[100px] animate-float-reverse">
    </div>
    <div
      class="absolute -bottom-40 left-1/3 w-[500px] h-[500px] rounded-full bg-fuchsia-600/8 blur-[130px] animate-float-slow">
    </div>
    <!-- å°è£é£¾é» -->
    <div class="absolute top-[15%] left-[10%] w-2 h-2 bg-purple-400/30 rounded-full animate-float"></div>
    <div class="absolute top-[25%] right-[15%] w-1.5 h-1.5 bg-indigo-400/25 rounded-full animate-float-reverse"></div>
    <div class="absolute top-[60%] left-[80%] w-2.5 h-2.5 bg-fuchsia-400/20 rounded-full animate-float-slow"></div>
    <div class="absolute top-[70%] left-[20%] w-1.5 h-1.5 bg-violet-400/25 rounded-full animate-float"></div>
    <div class="absolute top-[45%] left-[50%] w-2 h-2 bg-purple-400/20 rounded-full animate-float-reverse"></div>
  </div>

  <div id="root"></div>

  <script type="text/babel" data-type="module">
    import React, { useState, useEffect, useRef, useCallback } from 'react';
    import { createRoot } from 'react-dom/client';
    import {
      UploadCloud, FileText, Settings, Download, Loader2, AlertCircle,
      RefreshCw, ChevronRight, X, Shield, Zap, Sparkles, CheckCircle2,
      FileDown, Plus, Trash2, ArrowDownToLine
    } from 'lucide-react';

    const COMPRESSION_LEVELS = {
      low: {
        id: 'low',
        label: 'è¼•åº¦å£“ç¸®',
        desc: 'ä¿ç•™è¼ƒé«˜ç•«è³ªï¼Œæª”æ¡ˆç¸®å°å¹…åº¦è¼ƒå°',
        icon: 'ğŸ”',
        scale: 1.5,
        quality: 0.8,
        color: 'from-emerald-500/20 to-teal-500/20',
        borderColor: 'border-emerald-500/50',
        textColor: 'text-emerald-400',
        badge: 'é«˜å“è³ª',
      },
      medium: {
        id: 'medium',
        label: 'ä¸­åº¦å£“ç¸®',
        desc: 'ç•«è³ªèˆ‡æª”æ¡ˆå¤§å°çš„å®Œç¾å¹³è¡¡',
        icon: 'âš–ï¸',
        scale: 1.0,
        quality: 0.6,
        color: 'from-violet-500/20 to-purple-500/20',
        borderColor: 'border-violet-500/50',
        textColor: 'text-violet-400',
        badge: 'æ¨è–¦',
      },
      high: {
        id: 'high',
        label: 'æ¥µè‡´å£“ç¸®',
        desc: 'æª”æ¡ˆæœ€å°åŒ–ï¼Œç•«è³ªæœƒæœ‰äº›è¨±çŠ§ç‰²',
        icon: 'ğŸ—œï¸',
        scale: 0.7,
        quality: 0.4,
        color: 'from-orange-500/20 to-red-500/20',
        borderColor: 'border-orange-500/50',
        textColor: 'text-orange-400',
        badge: 'æœ€å°',
      },
    };

    /* ============ ä¸»æ‡‰ç”¨ ============ */
    function App() {
      const [scriptsLoaded, setScriptsLoaded] = useState(false);
      const [fileList, setFileList] = useState([]);
      const [level, setLevel] = useState('medium');
      const [isCompressing, setIsCompressing] = useState(false);
      const [error, setError] = useState('');
      const [isDragging, setIsDragging] = useState(false);
      const fileInputRef = useRef(null);

      /* ---- è¼‰å…¥ PDF è™•ç†å¥—ä»¶ ---- */
      useEffect(() => {
        const loadScript = (src) =>
          new Promise((resolve, reject) => {
            if (document.querySelector(`script[src="${src}"]`)) { resolve(); return; }
            const s = document.createElement('script');
            s.src = src;
            s.onload = resolve;
            s.onerror = reject;
            document.head.appendChild(s);
          });

        Promise.all([
          loadScript('https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js'),
          loadScript('https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js'),
        ])
          .then(() => setScriptsLoaded(true))
          .catch(() => setError('ç„¡æ³•è¼‰å…¥å£“ç¸®æ‰€éœ€çš„æ ¸å¿ƒå¥—ä»¶ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·šå¾Œé‡æ–°æ•´ç†é é¢ã€‚'));
      }, []);

      /* ---- æª”æ¡ˆç›¸é—œ ---- */
      const addFiles = useCallback((files) => {
        const pdfs = Array.from(files).filter(f => f.type === 'application/pdf');
        if (pdfs.length > 0) {
          setFileList(prev => [
            ...prev,
            ...pdfs.map(file => ({
              id: Math.random().toString(36).substr(2, 9),
              file,
              progress: 0,
              resultBlob: null,
              error: '',
              status: 'idle',
            })),
          ]);
          setError('');
        } else {
          setError('è«‹é¸æ“‡æœ‰æ•ˆçš„ PDF æª”æ¡ˆã€‚');
        }
      }, []);

      const handleFileChange = (e) => {
        addFiles(e.target.files);
        if (fileInputRef.current) fileInputRef.current.value = '';
      };

      const handleDragOver = (e) => { e.preventDefault(); setIsDragging(true); };
      const handleDragLeave = (e) => { e.preventDefault(); setIsDragging(false); };
      const handleDrop = (e) => { e.preventDefault(); setIsDragging(false); addFiles(e.dataTransfer.files); };

      const removeFile = (id) => setFileList(prev => prev.filter(item => item.id !== id));

      const formatBytes = (bytes, decimals = 2) => {
        if (!+bytes) return '0 Bytes';
        const k = 1024, dm = decimals < 0 ? 0 : decimals;
        const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return `${parseFloat((bytes / Math.pow(k, i)).toFixed(dm))} ${sizes[i]}`;
      };

      /* ---- å£“ç¸® ---- */
      const compressPDF = async () => {
        if (fileList.length === 0 || !scriptsLoaded) return;
        setIsCompressing(true);
        setError('');

        try {
          const { jsPDF } = window.jspdf;
          const pdfjsLib = window.pdfjsLib;
          pdfjsLib.GlobalWorkerOptions.workerSrc =
            'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';
          const currentLevel = COMPRESSION_LEVELS[level];

          for (let fi = 0; fi < fileList.length; fi++) {
            const cur = fileList[fi];
            if (cur.status === 'done') continue;

            setFileList(p => p.map((it, i) => i === fi ? { ...it, status: 'compressing' } : it));

            try {
              const buf = await cur.file.arrayBuffer();
              const pdf = await pdfjsLib.getDocument({ data: buf }).promise;
              const doc = new jsPDF({ orientation: 'portrait', unit: 'px', format: 'a4' });
              doc.deletePage(1);

              for (let pg = 1; pg <= pdf.numPages; pg++) {
                const page = await pdf.getPage(pg);
                const vp = page.getViewport({ scale: currentLevel.scale });
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.height = vp.height;
                canvas.width = vp.width;
                await page.render({ canvasContext: ctx, viewport: vp }).promise;

                const imgData = canvas.toDataURL('image/jpeg', currentLevel.quality);
                const orient = vp.width > vp.height ? 'l' : 'p';
                doc.addPage([vp.width, vp.height], orient);
                doc.setPage(pg);
                doc.addImage(imgData, 'JPEG', 0, 0, vp.width, vp.height);

                setFileList(p => p.map((it, i) =>
                  i === fi ? { ...it, progress: Math.round((pg / pdf.numPages) * 100) } : it
                ));
              }

              const blob = doc.output('blob');
              setFileList(p => p.map((it, i) =>
                i === fi ? { ...it, status: 'done', resultBlob: blob } : it
              ));
            } catch (err) {
              console.error(`Error compressing ${cur.file.name}:`, err);
              setFileList(p => p.map((it, i) =>
                i === fi ? { ...it, status: 'error', error: err.message } : it
              ));
            }
          }
        } catch (err) {
          console.error(err);
          setError('å£“ç¸®éç¨‹ç™¼ç”ŸéŒ¯èª¤ï¼š' + err.message);
        } finally {
          setIsCompressing(false);
        }
      };

      /* ---- ä¸‹è¼‰ ---- */
      const downloadSingleFile = (f) => {
        if (!f.resultBlob) return;
        const url = URL.createObjectURL(f.resultBlob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `compressed_${f.file.name}`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      };

      const downloadAllFiles = () => {
        fileList.forEach((f, i) => {
          if (f.resultBlob) setTimeout(() => downloadSingleFile(f), i * 500);
        });
      };

      const totalProgress = fileList.length > 0
        ? Math.round(fileList.reduce((s, f) => s + f.progress, 0) / fileList.length)
        : 0;

      const isAllDone = fileList.length > 0 && !isCompressing &&
        fileList.every(f => f.status === 'done' || f.status === 'error');

      const doneCount = fileList.filter(f => f.status === 'done').length;
      const totalSavedBytes = fileList
        .filter(f => f.status === 'done' && f.resultBlob)
        .reduce((s, f) => s + (f.file.size - f.resultBlob.size), 0);

      /* ============ æ¸²æŸ“ ============ */
      return (
        <div className="relative min-h-screen flex flex-col">
          <div className="flex-1 max-w-4xl mx-auto w-full px-4 sm:px-6 py-10 sm:py-16">

            {/* ========== Header ========== */}
            <div className="text-center mb-12 animate-slide-up">
              {/* åœ–ç¤º */}
              <div className="relative inline-flex items-center justify-center mb-6">
                <div className="absolute w-20 h-20 rounded-full bg-violet-500/20 animate-pulse-ring"></div>
                <div className="relative w-16 h-16 rounded-2xl bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center shadow-lg shadow-violet-500/30">
                  <FileText className="w-8 h-8 text-white" />
                </div>
              </div>
              {/* æ¨™é¡Œ */}
              <h1 className="text-4xl sm:text-5xl font-black tracking-tight mb-4">
                <span className="bg-clip-text text-transparent animate-gradient"
                  style={{ backgroundImage: 'linear-gradient(135deg, #c4b5fd, #a78bfa, #8b5cf6, #c084fc, #e879f9, #a78bfa, #c4b5fd)' }}>
                  PDF å£“ç¸®å·¥å…·
                </span>
              </h1>
              {/* å‰¯æ¨™ */}
              <p className="text-gray-400 text-lg max-w-md mx-auto leading-relaxed">
                åœ¨æ‚¨çš„ç€è¦½å™¨ä¸­å®‰å…¨ã€å¿«é€Ÿåœ°å£“ç¸® PDF æª”æ¡ˆ<br className="hidden sm:block" />
                ç„¡é ˆä¸Šå‚³ä¼ºæœå™¨ï¼Œä¿éšœéš±ç§å®‰å…¨
              </p>
              {/* ç‰¹è‰²æ¨™ç±¤ */}
              <div className="flex items-center justify-center gap-4 mt-6">
                {[
                  { icon: <Shield className="w-3.5 h-3.5" />, text: 'éš±ç§å®‰å…¨' },
                  { icon: <Zap className="w-3.5 h-3.5" />, text: 'é«˜é€Ÿè™•ç†' },
                  { icon: <Sparkles className="w-3.5 h-3.5" />, text: 'å…è²»ä½¿ç”¨' },
                ].map((tag, i) => (
                  <span key={i} className="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium text-purple-300 glass-light">
                    {tag.icon} {tag.text}
                  </span>
                ))}
              </div>
            </div>

            {/* ========== ä¸»å¡ç‰‡ ========== */}
            <div className="glass rounded-3xl shadow-2xl shadow-purple-900/20 overflow-hidden animate-slide-up delay-200"
              style={{ animationFillMode: 'both' }}>
              <div className="p-6 sm:p-8 lg:p-10">

                {fileList.length === 0 ? (
                  /* ====== ä¸Šå‚³å€ ====== */
                  <div
                    className={`upload-zone rounded-2xl p-10 sm:p-14 text-center cursor-pointer group transition-all duration-300 ${isDragging ? 'drag-active' : ''}`}
                    onClick={() => fileInputRef.current?.click()}
                    onDragOver={handleDragOver}
                    onDragLeave={handleDragLeave}
                    onDrop={handleDrop}
                  >
                    <div className="relative inline-flex items-center justify-center mb-6">
                      <div className="absolute w-24 h-24 rounded-full bg-violet-500/10 group-hover:bg-violet-500/20 transition-all duration-500 group-hover:scale-125"></div>
                      <div className="relative w-20 h-20 rounded-2xl bg-gradient-to-br from-violet-500/20 to-purple-600/20 border border-violet-500/30 flex items-center justify-center group-hover:scale-110 group-hover:border-violet-400/60 transition-all duration-300 group-hover:shadow-lg group-hover:shadow-violet-500/20">
                        <UploadCloud className="w-10 h-10 text-violet-400 group-hover:text-violet-300 transition-colors" />
                      </div>
                    </div>
                    <h3 className="text-xl font-bold text-white/90 mb-2">
                      é»æ“Šæˆ–æ‹–æ›³ PDF æª”æ¡ˆè‡³æ­¤
                    </h3>
                    <p className="text-gray-400 text-sm">
                      æ”¯æ´æ‰€æœ‰æ¨™æº– PDF æ ¼å¼ï¼Œå¯ä¸€æ¬¡é¸å–å¤šå€‹æª”æ¡ˆ
                    </p>
                    <input
                      type="file"
                      ref={fileInputRef}
                      onChange={handleFileChange}
                      accept="application/pdf"
                      multiple
                      className="hidden"
                    />
                  </div>
                ) : (
                  /* ====== è™•ç†æµç¨‹å€ ====== */
                  <div className="space-y-8">

                    {/* -- æ­¥é©ŸæŒ‡ç¤º (éå®Œæˆæ™‚) -- */}
                    {!isAllDone && (
                      <div className="flex items-center gap-2 text-xs font-medium text-gray-500">
                        <span className={`inline-flex items-center gap-1 px-2.5 py-1 rounded-full ${fileList.length > 0 ? 'bg-violet-500/20 text-violet-300' : 'bg-gray-700 text-gray-400'}`}>
                          1 é¸æ“‡æª”æ¡ˆ
                        </span>
                        <ChevronRight className="w-3 h-3 text-gray-600" />
                        <span className={`inline-flex items-center gap-1 px-2.5 py-1 rounded-full ${isCompressing ? 'bg-violet-500/20 text-violet-300' : 'bg-gray-700/50 text-gray-500'}`}>
                          2 è¨­å®šå£“ç¸®
                        </span>
                        <ChevronRight className="w-3 h-3 text-gray-600" />
                        <span className="inline-flex items-center gap-1 px-2.5 py-1 rounded-full bg-gray-700/50 text-gray-500">
                          3 ä¸‹è¼‰çµæœ
                        </span>
                      </div>
                    )}

                    {/* -- æª”æ¡ˆåˆ—è¡¨ -- */}
                    <div className="space-y-3">
                      {fileList.map((f, idx) => (
                        <div
                          key={f.id}
                          className="glass-card rounded-xl p-4 flex items-center gap-4 animate-slide-up hover:bg-white/[0.06] transition-colors group/item"
                          style={{ animationDelay: `${idx * 80}ms`, animationFillMode: 'both' }}
                        >
                          {/* åœ–ç¤º */}
                          <div className={`relative flex-shrink-0 w-11 h-11 rounded-xl flex items-center justify-center ${f.status === 'done'
                            ? 'bg-emerald-500/20 text-emerald-400'
                            : f.status === 'error'
                              ? 'bg-red-500/20 text-red-400'
                              : f.status === 'compressing'
                                ? 'bg-violet-500/20 text-violet-400'
                                : 'bg-white/10 text-gray-400'
                            }`}>
                            {f.status === 'compressing' ? (
                              <Loader2 className="w-5 h-5 animate-spin" />
                            ) : f.status === 'done' ? (
                              <CheckCircle2 className="w-5 h-5" />
                            ) : f.status === 'error' ? (
                              <AlertCircle className="w-5 h-5" />
                            ) : (
                              <FileText className="w-5 h-5" />
                            )}
                          </div>

                          {/* æª”æ¡ˆè³‡è¨Š */}
                          <div className="flex-1 min-w-0">
                            <h4 className="font-semibold text-white/90 text-sm truncate" title={f.file.name}>
                              {f.file.name}
                            </h4>
                            <div className="flex items-center gap-2 text-xs mt-0.5 text-gray-400">
                              <span>{formatBytes(f.file.size)}</span>
                              {f.status === 'compressing' && (
                                <span className="text-violet-400 font-medium">å£“ç¸®ä¸­ {f.progress}%</span>
                              )}
                              {f.status === 'done' && f.resultBlob && (
                                <>
                                  <ChevronRight className="w-3 h-3 text-gray-600" />
                                  <span className="text-emerald-400 font-bold">{formatBytes(f.resultBlob.size)}</span>
                                  <span className="text-emerald-400/60">
                                    (æ¸›å°‘ {Math.round((1 - f.resultBlob.size / f.file.size) * 100)}%)
                                  </span>
                                </>
                              )}
                              {f.status === 'error' && (
                                <span className="text-red-400 font-medium">å£“ç¸®å¤±æ•—</span>
                              )}
                            </div>
                            {/* é€²åº¦æ¢ */}
                            {f.status === 'compressing' && (
                              <div className="mt-2 w-full h-1 bg-white/5 rounded-full overflow-hidden">
                                <div
                                  className="h-full rounded-full progress-bar-gradient transition-all duration-300 ease-out"
                                  style={{ width: `${f.progress}%` }}
                                />
                              </div>
                            )}
                          </div>

                          {/* å‹•ä½œæŒ‰éˆ• */}
                          <div className="flex items-center gap-2 flex-shrink-0">
                            {!isCompressing && !isAllDone && (
                              <button
                                onClick={() => removeFile(f.id)}
                                className="p-1.5 rounded-lg text-gray-500 hover:text-red-400 hover:bg-red-500/10 transition-all opacity-0 group-hover/item:opacity-100"
                                title="ç§»é™¤æª”æ¡ˆ"
                              >
                                <X className="w-4 h-4" />
                              </button>
                            )}
                          </div>
                        </div>
                      ))}

                      {/* æ–°å¢æ›´å¤šæª”æ¡ˆ */}
                      {!isCompressing && !isAllDone && (
                        <button
                          onClick={() => fileInputRef.current?.click()}
                          className="w-full py-3 rounded-xl border border-dashed border-white/10 text-gray-500 hover:text-violet-400 hover:border-violet-500/40 hover:bg-violet-500/5 transition-all flex items-center justify-center gap-2 text-sm font-medium"
                        >
                          <Plus className="w-4 h-4" />
                          ç¹¼çºŒåŠ å…¥å…¶ä»–æª”æ¡ˆ
                        </button>
                      )}
                    </div>

                    {/* -- å£“ç¸®ç­‰ç´šé¸æ“‡ -- */}
                    {!isAllDone && (
                      <div className="space-y-4">
                        <h3 className="text-base font-semibold text-white/80 flex items-center gap-2">
                          <Settings className="w-4 h-4 text-gray-500" />
                          é¸æ“‡å£“ç¸®ç­‰ç´š
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
                          {Object.values(COMPRESSION_LEVELS).map((opt) => (
                            <button
                              key={opt.id}
                              onClick={() => !isCompressing && setLevel(opt.id)}
                              disabled={isCompressing}
                              className={`
                                relative p-5 rounded-xl text-left transition-all duration-300
                                ${level === opt.id
                                  ? `selected-card`
                                  : 'glass-card hover:bg-white/[0.08]'
                                }
                                ${isCompressing ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}
                              `}
                            >
                              {/* æ¨è–¦æ¨™ç±¤ */}
                              {opt.id === 'medium' && (
                                <span className="absolute -top-2.5 right-3 px-2 py-0.5 rounded-full text-[10px] font-bold bg-gradient-to-r from-violet-500 to-purple-500 text-white shadow-sm">
                                  æ¨è–¦
                                </span>
                              )}
                              <div className="flex items-center gap-3 mb-2">
                                <span className="text-2xl">{opt.icon}</span>
                                <div>
                                  <h4 className={`font-bold text-sm ${level === opt.id ? opt.textColor : 'text-white/80'}`}>
                                    {opt.label}
                                  </h4>
                                </div>
                              </div>
                              <p className="text-xs text-gray-400 leading-relaxed pl-11">
                                {opt.desc}
                              </p>
                              {/* é¸å–æŒ‡ç¤º */}
                              {level === opt.id && (
                                <div className="absolute top-3 right-3 w-5 h-5 rounded-full bg-violet-500 flex items-center justify-center">
                                  <svg className="w-3 h-3 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M5 13l4 4L19 7" />
                                  </svg>
                                </div>
                              )}
                            </button>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* -- å£“ç¸®æŒ‰éˆ• / çµæœå€ -- */}
                    {!isAllDone ? (
                      <div className="pt-2 space-y-4">
                        <button
                          onClick={compressPDF}
                          disabled={isCompressing || !scriptsLoaded || fileList.length === 0}
                          className={`
                            w-full py-4 rounded-xl font-bold text-lg flex items-center justify-center gap-2.5
                            ${isCompressing || !scriptsLoaded
                              ? 'bg-violet-600/30 text-violet-300/60 cursor-not-allowed'
                              : 'btn-primary text-white'
                            }
                          `}
                        >
                          {isCompressing ? (
                            <>
                              <Loader2 className="w-5 h-5 animate-spin" />
                              æ­£åœ¨å£“ç¸® ({totalProgress}%)...
                            </>
                          ) : !scriptsLoaded ? (
                            <>
                              <Loader2 className="w-5 h-5 animate-spin" />
                              è¼‰å…¥æ ¸å¿ƒæ¨¡çµ„ä¸­...
                            </>
                          ) : (
                            <>
                              <Zap className="w-5 h-5" />
                              é–‹å§‹å£“ç¸®æ‰€æœ‰æª”æ¡ˆ
                            </>
                          )}
                        </button>

                        {/* ç¸½é€²åº¦ */}
                        {isCompressing && (
                          <div className="w-full h-2 bg-white/5 rounded-full overflow-hidden">
                            <div
                              className="h-full rounded-full progress-bar-gradient transition-all duration-300 ease-out"
                              style={{ width: `${totalProgress}%` }}
                            />
                          </div>
                        )}
                      </div>
                    ) : (
                      /* ====== å®Œæˆçµæœå€ ====== */
                      <div className="animate-celebrate">
                        <div className="rounded-2xl p-8 text-center"
                          style={{ background: 'linear-gradient(135deg, rgba(16,185,129,0.1), rgba(52,211,153,0.05))' }}>
                          {/* æˆåŠŸåœ–ç¤º */}
                          <div className="relative inline-flex items-center justify-center mb-5">
                            <div className="absolute w-20 h-20 rounded-full bg-emerald-500/15 animate-pulse-ring"></div>
                            <div className="relative w-16 h-16 rounded-2xl bg-gradient-to-br from-emerald-500 to-teal-500 flex items-center justify-center shadow-lg shadow-emerald-500/30">
                              <CheckCircle2 className="w-8 h-8 text-white" />
                            </div>
                          </div>
                          <h3 className="text-2xl font-black text-emerald-300 mb-2">å£“ç¸®å®Œæˆï¼</h3>
                          <p className="text-sm text-gray-400 mb-6">
                            æˆåŠŸè™•ç† <span className="text-emerald-400 font-bold">{doneCount}</span> å€‹æª”æ¡ˆ
                            {totalSavedBytes > 0 && (
                              <>ï¼Œå…±ç¯€çœ <span className="text-emerald-400 font-bold">{formatBytes(totalSavedBytes)}</span></>
                            )}
                          </p>

                          {/* çµæœåˆ—è¡¨ */}
                          <div className="space-y-2 mb-8 text-left max-h-60 overflow-y-auto">
                            {fileList.map((f) => (
                              <div key={f.id} className="glass-card rounded-xl p-3 flex items-center gap-3">
                                <div className={`flex-shrink-0 w-9 h-9 rounded-lg flex items-center justify-center ${f.status === 'done' ? 'bg-emerald-500/20 text-emerald-400' : 'bg-red-500/20 text-red-400'
                                  }`}>
                                  {f.status === 'done' ? <FileDown className="w-4 h-4" /> : <AlertCircle className="w-4 h-4" />}
                                </div>
                                <div className="flex-1 min-w-0">
                                  <span className="text-sm font-semibold text-white/80 truncate block">{f.file.name}</span>
                                  {f.status === 'error' ? (
                                    <span className="text-red-400 text-xs">è™•ç†å¤±æ•—</span>
                                  ) : (
                                    <div className="flex items-center gap-1.5 text-xs text-gray-400">
                                      <span>{formatBytes(f.file.size)}</span>
                                      <ChevronRight className="w-3 h-3 text-gray-600" />
                                      <span className="text-emerald-400 font-bold">{f.resultBlob ? formatBytes(f.resultBlob.size) : '-'}</span>
                                      {f.resultBlob && (
                                        <span className="text-emerald-500/60 ml-0.5">
                                          -{Math.round((1 - f.resultBlob.size / f.file.size) * 100)}%
                                        </span>
                                      )}
                                    </div>
                                  )}
                                </div>
                                {f.resultBlob && (
                                  <button
                                    onClick={() => downloadSingleFile(f)}
                                    className="flex-shrink-0 px-3 py-1.5 rounded-lg text-xs font-semibold bg-emerald-500/20 text-emerald-400 hover:bg-emerald-500/30 transition-colors flex items-center gap-1.5"
                                  >
                                    <Download className="w-3.5 h-3.5" />
                                    ä¸‹è¼‰
                                  </button>
                                )}
                              </div>
                            ))}
                          </div>

                          {/* æ“ä½œæŒ‰éˆ• */}
                          <div className="flex flex-col sm:flex-row items-center justify-center gap-3">
                            <button
                              onClick={downloadAllFiles}
                              className="w-full sm:w-auto px-8 py-3.5 rounded-xl font-bold text-base btn-success text-white flex items-center justify-center gap-2"
                            >
                              <ArrowDownToLine className="w-5 h-5" />
                              ä¸‹è¼‰å…¨éƒ¨æª”æ¡ˆ
                            </button>
                            <button
                              onClick={() => { setFileList([]); setError(''); }}
                              className="w-full sm:w-auto px-8 py-3.5 rounded-xl font-bold text-base glass-light text-gray-300 hover:text-white hover:bg-white/15 transition-all flex items-center justify-center gap-2"
                            >
                              <RefreshCw className="w-4 h-4" />
                              é‡æ–°è™•ç†
                            </button>
                          </div>
                        </div>
                      </div>
                    )}

                    {/* -- éŒ¯èª¤è¨Šæ¯ -- */}
                    {error && (
                      <div className="p-4 rounded-xl flex items-start gap-3 animate-slide-up"
                        style={{ background: 'rgba(239,68,68,0.1)', border: '1px solid rgba(239,68,68,0.2)' }}>
                        <AlertCircle className="w-5 h-5 text-red-400 flex-shrink-0 mt-0.5" />
                        <span className="text-red-300 text-sm">{error}</span>
                      </div>
                    )}
                  </div>
                )}
              </div>
            </div>

            {/* éš±è— inputï¼ˆæª”æ¡ˆåˆ—è¡¨å‡ºç¾å¾Œä»å¯ç”¨ï¼‰ */}
            <input
              type="file"
              ref={fileInputRef}
              onChange={handleFileChange}
              accept="application/pdf"
              multiple
              className="hidden"
            />
          </div>

          {/* ========== Footer ========== */}
          <footer className="py-8 text-center animate-fade-in">
            <p className="text-xs text-gray-500 mb-4">
              æ‰€æœ‰è™•ç†çš†åœ¨æ‚¨çš„ç€è¦½å™¨ç«¯å®Œæˆï¼Œæª”æ¡ˆä¸æœƒä¸Šå‚³è‡³ä»»ä½•ä¼ºæœå™¨
            </p>
            <a
              href="https://www.twainews.com.tw/"
              target="_blank"
              rel="noopener noreferrer"
              className="inline-flex items-center gap-3 px-5 py-2.5 rounded-full glass-light hover:bg-white/15 transition-all group"
            >
              <div className="w-7 h-7 rounded-full bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center group-hover:shadow-md group-hover:shadow-violet-500/30 transition-all">
                <svg className="w-3.5 h-3.5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2.5} d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
              </div>
              <span className="text-sm font-bold text-gray-400 group-hover:text-violet-300 transition-colors tracking-wide">
                TWAI NEWS è£½ä½œæä¾›
              </span>
            </a>
          </footer>
        </div>
      );
    }

    const root = createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>

</html>